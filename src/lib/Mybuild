package embox.lib

static module LibElf {
	source "elf/elf_object.c"
	source "elf/elf_header.c"
	source "elf/elf_sh_table.c"
	source "elf/elf_ph_table.c"
	source "elf/elf_section.c"
	source "elf/elf_string_table.c"
	source "elf/elf_sym_table.c"
	source "elf/elf_sym_names.c"
	source "elf/elf_dyn_section.c"
	source "elf/elf_rel.c"
	source "elf/elf_rel_array.c"

	// TODO: Delete it later
	source "elf/elf_reader.c"
}

static module LibDl {
	source "dl/elf_reloc.c"
}

static module LibCDiagnostic {
	source "assert.c"
	depends LibCStdio
}

static module LibCMisc {
	source "crypt/crc32.c"
	source "crypt/md5.c"
	source "ctype/ctype.c"
}

static module LibCStdlib {
	source "stdlib/bsearch.c"
	source "stdlib/qsort.c"
	source "stdlib/rand.c"
	source "stdlib/strtod.c"
	source "stdlib/strtol.c"
	source "stdlib/strtoul.c"
	source "stdlib/abort.c"
}

static module LibCString {
	source "string/memchr.c"
	source "string/memcmp.c"
	source "string/memmove.c"
	source "string/memset.c"
	source "string/strcat.c"
	source "string/strchr.c"
	source "string/strcmp.c"
	source "string/strcpy.c"
	source "string/strcspn.c"
	source "string/strerror.c"
	source "string/strlen.c"
	source "string/strlwr.c"
	source "string/strncat.c"
	source "string/strncmp.c"
	source "string/strncpy.c"
	source "string/strpbrk.c"
	source "string/strrchr.c"
	source "string/strspn.c"
	source "string/strstr.c"
	source "string/strupr.c"
}

static module LibCMath {
	source "math/floor.c"
	source "math/pow.c"
	source "math/div.c"
	source "math/ldiv.c"
	source "math/blog2.c"
	source "soft-fp/df3.c"
	source "soft-fp/sf3.c"
	source "soft-fp/softfloat.c"
	source "soft-fp/softfloat-macros.c"
	source "soft-fp/softfloat-spec.c"
	source "gcc/clzsi2.c"
	source "gcc/lshrdi3.c"
	source "gcc/divdi3.c"
	source "gcc/divsi3.c"
	source "gcc/moddi3.c"
	source "gcc/modsi3.c"
	source "gcc/udivdi3.c"
	source "gcc/udivsi3.c"
	source "gcc/umoddi3.c"
	source "gcc/umodsi3.c"
	source "gcc/muldi3.c"
}

static module LibCStdio {

	option boolean stdio_lf_crlf_map = true

	source "stdio/file_ops.c"
	source "stdio/fgetc.c"
	source "stdio/fputc.c"
	source "stdio/gets.c"
	source "stdio/sprintf.c"
	source "stdio/printf.c"
	source "stdio/printf_impl.c"
	source "stdio/printk.c"
	source "stdio/puts.c"
	source "stdio/scanf.c"
	depends FileApi
	depends LibCMath
}

static module LibC {
	source "time/ctime.c"

	depends LibCDiagnostic
	depends LibCMisc
	depends LibCStdlib
	depends LibCString
	depends LibCMath
	depends	LibCStdio
/* not here */
	source "shell/tokenizer.c"
	source "readline/readline.c"

//	source "stacktrace.c"
}

@DefaultImpl(FilePosix)
abstract module FileApi { }

static module FileFS extends FileApi {
	source "stdio/file_fs.h"
	source "stdio/file_fs.c"

	depends embox.fs.core
}

module FilePosix extends FileApi {
	@IncludePath("$(SRC_DIR)/compat/posix/include")
	source "stdio/file_posix.h",
		"stdio/file_posix_open.h"

	depends embox.compat.posix.FileTasks
}

module FilePosixNoOpen extends FileApi {
	@IncludePath("$(SRC_DIR)/compat/posix/include")
	source "stdio/file_posix.h",
		"stdio/file_posix_noopen.h"

	depends embox.compat.posix.FileTasksBasic
}

module FileStdio extends FileApi {
	source "stdio/file_diag.h",
		"stdio/file_posix_noopen.h"
}
